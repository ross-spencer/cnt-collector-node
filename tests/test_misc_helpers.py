"""Location for some smaller helper functions in the indexer."""

# pylint: disable=C0302

import datetime
from datetime import timezone

import pytest
import time_machine

from src.cnt_collector_node import utxo_objects
from src.cnt_collector_node.global_helpers import calculate_price, read_pairs_config

calculate_price_tests = [
    (
        [
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "MinSwap",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                "feed": "ADA-USDM",
                "utxo": "dc91ee512f0a523374f979e29bb795becc7d70ced53b39ccb7e1941becded3a4#0",
                "token1_volume": 119.452869,
                "token2_volume": 74.469554,
                "price": 0.623422062805373,
                "amounts": {
                    "lovelace": 119452869,
                    "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad.0014df105553444d": 74469554,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "SundaeSwapV3",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz2auzrlrz2kdd83wzt9u9n9qt2swgvhrmmn96k55nq6yuj4qw992w9",
                "feed": "ADA-USDM",
                "utxo": "43d95314139b177dc074d50ddd45387b4cc94b88e94301a6229cd0ed8ce8405b#0",
                "token1_volume": 1148228.783832,
                "token2_volume": 746578.421918,
                "price": 0.650200058063719,
                "amounts": {
                    "lovelace": 1148228783832,
                    "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad.0014df105553444d": 746578421918,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "WingRiders",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnaytmskjm3nhaazcv20yhs07hel96yv29zuf0gzlk5dt9ugzs2y5pq5",
                "feed": "ADA-USDM",
                "utxo": "4e202b4dba2665ff5e1f022819c8c8de83c42cfee3ab4bf259ed2f122446420e#0",
                "token1_volume": 500.316158,
                "token2_volume": 338.308714,
                "price": 0.6761898623310103,
                "amounts": {
                    "lovelace": 500316158,
                    "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad.0014df105553444d": 338308714,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "WingRidersV2",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhqlm3e807762pklheldndtjhrk0qxzzfh9vhc9kkc706xglsv8s5nq",
                "feed": "ADA-USDM",
                "utxo": "4569b3483653dea2e05c675e408fcbfd5558e4417aea0fe866076ec0716e9256#0",
                "token1_volume": 339455.464175,
                "token2_volume": 221038.59173,
                "price": 0.6511563814923528,
                "amounts": {
                    "lovelace": 339455464175,
                    "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad.0014df105553444d": 221038591730,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "SundaeSwap",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1w9qzpelu9hn45pefc0xr4ac4kdxeswq7pndul2vuj59u8tqaxdznu",
                "feed": "ADA-USDM",
                "utxo": "7fbf9ba38cead768c5b544bdd19f81ca23c871b746c171d89927c71377845e42#0",
                "token1_volume": 2.107464,
                "token2_volume": 0.001129,
                "price": 0.0005357149635770766,
                "amounts": {
                    "lovelace": 2107464,
                    "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad.0014df105553444d": 1129,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "ADA-USDM",
                "utxo": "00f89b6ab12ec840f0883564e24a11d221a49bc7fe2f4b86e78ba03cd8395693#1",
                "token1_volume": 15.180126,
                "token2_volume": 10.127849,
                "price": 0.6671781907475604,
                "amounts": {
                    "lovelace": 15180126,
                    "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad.0014df105553444d": 10127849,
                },
            },
        ],
        0.6504240165658044,
    ),
    (
        [
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "69555344",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "MinSwap",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                "feed": "ADA-iUSD",
                "utxo": "6865ae70bc283661f5c1faa295af566f470182e07eb078860f91be525a00a3ec#0",
                "token1_volume": 9498.013765,
                "token2_volume": 6268.380736,
                "price": 0.6599675354334466,
                "amounts": {
                    "lovelace": 9498013765,
                    "f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880.69555344": 6268380736,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "69555344",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "SundaeSwapV3",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz2auzrlrz2kdd83wzt9u9n9qt2swgvhrmmn96k55nq6yuj4qw992w9",
                "feed": "ADA-iUSD",
                "utxo": "8ef0d92cee8640126b5f8bf3906e638800a5eda373d1b9244f75aba053fb9300#0",
                "token1_volume": 24212.385005,
                "token2_volume": 15625.242127,
                "price": 0.6453408916045774,
                "amounts": {
                    "lovelace": 24212385005,
                    "f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880.69555344": 15625242127,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "69555344",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "WingRiders",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnaytpq3ryg76qvca5eu9c6py33ncg8zf09nh7gy2cvdps2yeqlvvkfh",
                "feed": "ADA-iUSD",
                "utxo": "85957ad83a4b5677ea12e113be93563c83c9bfa66151c5bc63e358e0eeb42848#0",
                "token1_volume": 3591.224421,
                "token2_volume": 2349.207456,
                "price": 0.6541522279317337,
                "amounts": {
                    "lovelace": 3591224421,
                    "f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880.69555344": 2349207456,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "69555344",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "WingRidersV2",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhq7nzm5jzjeevh40p5h3f682mv3r6fnnsldx749n52asr6vsnevx3j",
                "feed": "ADA-iUSD",
                "utxo": "0dac7bf65996edf309527f4f2f371b0cd23ea3f572abc354f1dc8a5287b736dc#0",
                "token1_volume": 2551.335698,
                "token2_volume": 1654.080527,
                "price": 0.6483194384402802,
                "amounts": {
                    "lovelace": 2551335698,
                    "f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880.69555344": 1654080527,
                },
            },
            {
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_name": "69555344",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x8nz307k3sr60gu0e47cmajssy4fmld7u493a4xztjrll0aj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrswgxsta",
                "feed": "ADA-iUSD",
                "utxo": "dcc931860b23dffc2f2e25e0533cfe1f756792eb84462ffc3c2fe4072b614129#0",
                "token1_volume": 150.000001,
                "token2_volume": 46.0828,
                "price": 0.30721866461854225,
                "amounts": {
                    "lovelace": 150000001,
                    "f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880.69555344": 46082800,
                },
            },
        ],
        0.6485268681583768,
    ),
    (
        [
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "MinSwap",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                "feed": "CBLP-ADA",
                "utxo": "58466346f8778f756dda25f5056c2b52e67e2732f0b4857c6e5b2a9287ee5fc5#0",
                "token1_volume": 1319373.299185,
                "token2_volume": 447.421434,
                "price": 0.0003391166353573928,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1319373299185,
                    "lovelace": 447421434,
                },
            },
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "SundaeSwapV3",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz26rnxqnmtv3hdu2t6chcfhl2zzjh36a87nmd6dwsu3jenqsslnz7e",
                "feed": "CBLP-ADA",
                "utxo": "4ac5c4db431e76c7085625dcd89283bf571f35ad95a28bd1a4b0aa77e14c917d#0",
                "token1_volume": 289.10765,
                "token2_volume": 44.725475,
                "price": 0.15470180398201155,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 289107650,
                    "lovelace": 44725475,
                },
            },
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "CBLP-ADA",
                "utxo": "1c4fce9ef701f5841e8734cd6ccb282c87fa7af1add3be271b867aed451981e4#0",
                "token1_volume": 1126.795042,
                "token2_volume": 7.531517,
                "price": 0.006684016808089576,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1126795042,
                    "lovelace": 7531517,
                },
            },
        ],
        0.0003783180732321986,
    ),
    # Prices don't match, returns None.
    (
        [
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "MinSwap",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                "feed": "CBLP-ADA",
                "utxo": "58466346f8778f756dda25f5056c2b52e67e2732f0b4857c6e5b2a9287ee5fc5#0",
                "token1_volume": 1319373.299185,
                "token2_volume": 9999,  # Should be 447.4214349
                "price": 0.0003391166353573928,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1319373299185,
                    "lovelace": 447421434,
                },
            },
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "SundaeSwapV3",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz26rnxqnmtv3hdu2t6chcfhl2zzjh36a87nmd6dwsu3jenqsslnz7e",
                "feed": "CBLP-ADA",
                "utxo": "4ac5c4db431e76c7085625dcd89283bf571f35ad95a28bd1a4b0aa77e14c917d#0",
                "token1_volume": 289.10765,
                "token2_volume": 44.725475,
                "price": 0.15470180398201155,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 289107650,
                    "lovelace": 44725475,
                },
            },
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "CBLP-ADA",
                "utxo": "1c4fce9ef701f5841e8734cd6ccb282c87fa7af1add3be271b867aed451981e4#0",
                "token1_volume": 1126.795042,
                "token2_volume": 7.531517,
                "price": 0.006684016808089576,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1126795042,
                    "lovelace": 7531517,
                },
            },
        ],
        None,
    ),
    # Attempt to divide by zero. Return None.
    (
        [
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "MinSwap",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                "feed": "CBLP-ADA",
                "utxo": "58466346f8778f756dda25f5056c2b52e67e2732f0b4857c6e5b2a9287ee5fc5#0",
                "token1_volume": 1319373.299185,
                "token2_volume": 0,
                "price": 0.0003391166353573928,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1319373299185,
                    "lovelace": 447421434,
                },
            },
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "SundaeSwapV3",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz26rnxqnmtv3hdu2t6chcfhl2zzjh36a87nmd6dwsu3jenqsslnz7e",
                "feed": "CBLP-ADA",
                "utxo": "4ac5c4db431e76c7085625dcd89283bf571f35ad95a28bd1a4b0aa77e14c917d#0",
                "token1_volume": 289.10765,
                "token2_volume": 44.725475,
                "price": 0.15470180398201155,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 289107650,
                    "lovelace": 44725475,
                },
            },
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "CBLP-ADA",
                "utxo": "1c4fce9ef701f5841e8734cd6ccb282c87fa7af1add3be271b867aed451981e4#0",
                "token1_volume": 1126.795042,
                "token2_volume": 7.531517,
                "price": 0.006684016808089576,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1126795042,
                    "lovelace": 7531517,
                },
            },
        ],
        None,
    ),
    # We have a single message.
    (
        [
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "CBLP-ADA",
                "utxo": "1c4fce9ef701f5841e8734cd6ccb282c87fa7af1add3be271b867aed451981e4#0",
                "token1_volume": 1126.795042,
                "token2_volume": 7.531517,
                "price": 0.006684016808089576,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1126795042,
                    "lovelace": 7531517,
                },
            },
        ],
        0.006684016808089576,
    ),
    # We haven't any data.
    (
        [],
        None,
    ),
    (
        {},
        None,
    ),
    # AttributeError
    (
        [1],
        None,
    ),
    # Int isn't iterable. Simulates incorrect raw data.
    (
        1,
        None,
    ),
    # Token 1 volume is zero.
    (
        [
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "CBLP-ADA",
                "utxo": "1c4fce9ef701f5841e8734cd6ccb282c87fa7af1add3be271b867aed451981e4#0",
                "token1_volume": 0,
                "token2_volume": 7.531517,
                "price": 0.006684016808089576,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1126795042,
                    "lovelace": 7531517,
                },
            },
        ],
        None,
    ),
    # Token 2 volume is zero.
    (
        [
            {
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "block_height": 170161750,
                "source": "Spectrum",
                "collector": "cnt-collector-node/2.3.0",
                "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                "feed": "CBLP-ADA",
                "utxo": "1c4fce9ef701f5841e8734cd6ccb282c87fa7af1add3be271b867aed451981e4#0",
                "token1_volume": 1126.795042,
                "token2_volume": 0,
                "price": 0.006684016808089576,
                "amounts": {
                    "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd.43424c50": 1126795042,
                    "lovelace": 7531517,
                },
            },
        ],
        None,
    ),
]


@pytest.mark.parametrize("raw_data, expected", calculate_price_tests)
def test_calculate_price(raw_data: dict, expected: float):
    """Test calculate price."""

    res = calculate_price(raw_data=raw_data)
    assert res == expected


check_token_pairs_tests = [
    (
        [
            {
                "name": "ADA-USDM",
                "token1_policy": "",
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_policy": "c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                "token2_name": "0014df105553444d",
                "token2_decimals": 6,
                "sources": [
                    {
                        "source": "MinSwap",
                        "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                        "security_token_policy": "0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                        "security_token_name": "116df62938bc100b55c0e72b57a48dced2f928635ad66660bc165a8f40f8e735",
                    },
                    {
                        "source": "MinSwapV2",
                        "address": "addr1z84q0denmyep98ph3tmzwsmw0j7zau9ljmsqx6a4rvaau66j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq777e2a",
                        "security_token_policy": "f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                        "security_token_name": "4d5350",
                    },
                    {
                        "source": "SundaeSwapV3",
                        "address": "addr1z8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz2auzrlrz2kdd83wzt9u9n9qt2swgvhrmmn96k55nq6yuj4qw992w9",
                        "security_token_policy": "e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                        "security_token_name": "000de14064f35d26b237ad58e099041bc14c687ea7fdc58969d7d5b66e2540ef",
                    },
                    {
                        "source": "WingRiders",
                        "address": "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnaytmskjm3nhaazcv20yhs07hel96yv29zuf0gzlk5dt9ugzs2y5pq5",
                        "security_token_policy": "026a18d04a0c642759bb3d83b12e3344894e5c1c7b2aeb1a2113a570",
                        "security_token_name": "4c",
                    },
                    {
                        "source": "WingRidersV2",
                        "address": "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhqlm3e807762pklheldndtjhrk0qxzzfh9vhc9kkc706xglsv8s5nq",
                        "security_token_policy": "6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737",
                        "security_token_name": "4c",
                    },
                    {
                        "source": "SundaeSwap",
                        "address": "addr1w9qzpelu9hn45pefc0xr4ac4kdxeswq7pndul2vuj59u8tqaxdznu",
                        "security_token_policy": "0029cb7c88c7567b63d1a512c0ed626aa169688ec980730c0473b913",
                        "security_token_name": "70204f05",
                    },
                    {
                        "source": "Spectrum",
                        "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                        "security_token_policy": "fd0b614f52f2286df3b4db4fc70656bcd3df4877e909fd5a44e956f0",
                        "security_token_name": "0014efbfbd105553444d5f4144415f4e4654",
                    },
                ],
            },
            {
                "name": "ADA-iUSD",
                "token1_policy": "",
                "token1_name": "lovelace",
                "token1_decimals": 6,
                "token2_policy": "f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                "token2_name": "69555344",
                "token2_decimals": 6,
                "sources": [
                    {
                        "source": "MinSwap",
                        "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                        "security_token_policy": "0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                        "security_token_name": "8fde43a3f0b9f0e6f63bec7335e0b855c6b62a4dc51f1b762ccb6dfbbafcfe47",
                    },
                    {
                        "source": "MinSwapV2",
                        "address": "addr1z84q0denmyep98ph3tmzwsmw0j7zau9ljmsqx6a4rvaau66j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq777e2a",
                        "security_token_policy": "f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                        "security_token_name": "4d5350",
                    },
                    {
                        "source": "SundaeSwapV3",
                        "address": "addr1z8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz2auzrlrz2kdd83wzt9u9n9qt2swgvhrmmn96k55nq6yuj4qw992w9",
                        "security_token_policy": "e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                        "security_token_name": "000de140c7ef237f227542a0c8930d37911491c56a341fdef8437e0f21d024f8",
                    },
                    {
                        "source": "WingRiders",
                        "address": "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnaytpq3ryg76qvca5eu9c6py33ncg8zf09nh7gy2cvdps2yeqlvvkfh",
                        "security_token_policy": "026a18d04a0c642759bb3d83b12e3344894e5c1c7b2aeb1a2113a570",
                        "security_token_name": "4c",
                    },
                    {
                        "source": "WingRidersV2",
                        "address": "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhq7nzm5jzjeevh40p5h3f682mv3r6fnnsldx749n52asr6vsnevx3j",
                        "security_token_policy": "6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737",
                        "security_token_name": "4c",
                    },
                    {
                        "source": "Spectrum",
                        "address": "addr1x8nz307k3sr60gu0e47cmajssy4fmld7u493a4xztjrll0aj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrswgxsta",
                        "security_token_policy": "e36480a99003832c2a4dd7b9919915e5c9b5b00244117e5f5ece009d",
                        "security_token_name": "697573645f4144415f4e4654",
                    },
                ],
            },
            {
                "name": "CBLP-ADA",
                "token1_policy": "ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd",
                "token1_name": "43424c50",
                "token1_decimals": 6,
                "token2_policy": "",
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "sources": [
                    {
                        "source": "MinSwap",
                        "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                        "security_token_policy": "0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                        "security_token_name": "dfe1be4e42a1cf6a8f5648e904bef0b4b11ee8ca4131521b5256856ef34e3486",
                    },
                    {
                        "source": "MinSwapV2",
                        "address": "addr1z84q0denmyep98ph3tmzwsmw0j7zau9ljmsqx6a4rvaau66j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq777e2a",
                        "security_token_policy": "f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                        "security_token_name": "4d5350",
                    },
                    {
                        "source": "SundaeSwapV3",
                        "address": "addr1x8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz26rnxqnmtv3hdu2t6chcfhl2zzjh36a87nmd6dwsu3jenqsslnz7e",
                        "security_token_policy": "e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                        "security_token_name": "000de140549bd196264a186d09e00bcfd41727622e515154612f76dc6b8120b9",
                    },
                    {
                        "source": "Spectrum",
                        "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                        "security_token_policy": "1e707f0a237ccf47bc9eb02184442459761ab0a0096eed2b27a2f2d9",
                        "security_token_name": "43424c505f4144415f4e4654",
                    },
                ],
            },
            {
                "name": "FACT-ADA",
                "token1_policy": "a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                "token1_name": "6f7263666178746f6b656e",
                "token1_decimals": 6,
                "token2_policy": "",
                "token2_name": "lovelace",
                "token2_decimals": 6,
                "sources": [
                    {
                        "source": "MinSwap",
                        "address": "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha",
                        "security_token_policy": "0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                        "security_token_name": "b4ba2b47edce71234f328fa20efdb25c3f96e348ca19a683193880489bb368db",
                    },
                    {
                        "source": "MinSwapV2",
                        "address": "addr1z84q0denmyep98ph3tmzwsmw0j7zau9ljmsqx6a4rvaau66j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq777e2a",
                        "security_token_policy": "f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                        "security_token_name": "4d5350",
                    },
                    {
                        "source": "SundaeSwapV3",
                        "address": "addr1z8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz2auzrlrz2kdd83wzt9u9n9qt2swgvhrmmn96k55nq6yuj4qw992w9",
                        "security_token_policy": "e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                        "security_token_name": "000de140a5b624b96af21138b6dff057e0499e7f767fcfe7ac8adb549f3818d7",
                    },
                    {
                        "source": "WingRiders",
                        "address": "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnayg6pp9snyy9v7uwarxd7dqc5k52egtc49y5w5h3nqqdy6qs2nzs8y",
                        "security_token_policy": "026a18d04a0c642759bb3d83b12e3344894e5c1c7b2aeb1a2113a570",
                        "security_token_name": "4c",
                    },
                    {
                        "source": "WingRidersV2",
                        "address": "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhqadav244fusrvfjcrdra646ude8dlctzmv6wvsqtndwrdfsvg56qt",
                        "security_token_policy": "6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737",
                        "security_token_name": "4c",
                    },
                    {
                        "source": "SundaeSwap",
                        "address": "addr1w9qzpelu9hn45pefc0xr4ac4kdxeswq7pndul2vuj59u8tqaxdznu",
                        "security_token_policy": "0029cb7c88c7567b63d1a512c0ed626aa169688ec980730c0473b913",
                        "security_token_name": "7020fb04",
                    },
                    {
                        "source": "Spectrum",
                        "address": "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu",
                        "security_token_policy": "d740d4088886a6b7e4ab8293424308515590e93e826cb874f8c92aff",
                        "security_token_name": "6f7263666178746f6b656e5f4144415f4e4654",
                    },
                ],
            },
        ],
        {
            "addr1z8snz7c4974vzdpxu65ruphl3zjdvtxw8strf2c2tmqnxz2j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq0xmsha": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="MinSwap",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                    security_token_name="116df62938bc100b55c0e72b57a48dced2f928635ad66660bc165a8f40f8e735",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="ADA-iUSD",
                    source="MinSwap",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                    token_2_name="69555344",
                    token_2_decimals=6,
                    security_token_policy="0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                    security_token_name="8fde43a3f0b9f0e6f63bec7335e0b855c6b62a4dc51f1b762ccb6dfbbafcfe47",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="CBLP-ADA",
                    source="MinSwap",
                    token_1_policy="ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd",
                    token_1_name="43424c50",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                    security_token_name="dfe1be4e42a1cf6a8f5648e904bef0b4b11ee8ca4131521b5256856ef34e3486",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="MinSwap",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="0be55d262b29f564998ff81efe21bdc0022621c12f15af08d0f2ddb1",
                    security_token_name="b4ba2b47edce71234f328fa20efdb25c3f96e348ca19a683193880489bb368db",
                    address=None,
                    collector=None,
                ),
            ],
            "addr1z84q0denmyep98ph3tmzwsmw0j7zau9ljmsqx6a4rvaau66j2c79gy9l76sdg0xwhd7r0c0kna0tycz4y5s6mlenh8pq777e2a": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="MinSwapV2",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                    security_token_name="4d5350",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="ADA-iUSD",
                    source="MinSwapV2",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                    token_2_name="69555344",
                    token_2_decimals=6,
                    security_token_policy="f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                    security_token_name="4d5350",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="CBLP-ADA",
                    source="MinSwapV2",
                    token_1_policy="ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd",
                    token_1_name="43424c50",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                    security_token_name="4d5350",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="MinSwapV2",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="f5808c2c990d86da54bfc97d89cee6efa20cd8461616359478d96b4c",
                    security_token_name="4d5350",
                    address=None,
                    collector=None,
                ),
            ],
            "addr1z8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz2auzrlrz2kdd83wzt9u9n9qt2swgvhrmmn96k55nq6yuj4qw992w9": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="SundaeSwapV3",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                    security_token_name="000de14064f35d26b237ad58e099041bc14c687ea7fdc58969d7d5b66e2540ef",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="ADA-iUSD",
                    source="SundaeSwapV3",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                    token_2_name="69555344",
                    token_2_decimals=6,
                    security_token_policy="e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                    security_token_name="000de140c7ef237f227542a0c8930d37911491c56a341fdef8437e0f21d024f8",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="SundaeSwapV3",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                    security_token_name="000de140a5b624b96af21138b6dff057e0499e7f767fcfe7ac8adb549f3818d7",
                    address=None,
                    collector=None,
                ),
            ],
            "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnaytmskjm3nhaazcv20yhs07hel96yv29zuf0gzlk5dt9ugzs2y5pq5": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="WingRiders",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="026a18d04a0c642759bb3d83b12e3344894e5c1c7b2aeb1a2113a570",
                    security_token_name="4c",
                    address=None,
                    collector=None,
                )
            ],
            "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhqlm3e807762pklheldndtjhrk0qxzzfh9vhc9kkc706xglsv8s5nq": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="WingRidersV2",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737",
                    security_token_name="4c",
                    address=None,
                    collector=None,
                )
            ],
            "addr1w9qzpelu9hn45pefc0xr4ac4kdxeswq7pndul2vuj59u8tqaxdznu": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="SundaeSwap",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="0029cb7c88c7567b63d1a512c0ed626aa169688ec980730c0473b913",
                    security_token_name="70204f05",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="SundaeSwap",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="0029cb7c88c7567b63d1a512c0ed626aa169688ec980730c0473b913",
                    security_token_name="7020fb04",
                    address=None,
                    collector=None,
                ),
            ],
            "addr1x94ec3t25egvhqy2n265xfhq882jxhkknurfe9ny4rl9k6dj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrst84slu": [
                utxo_objects.TokensPair(
                    pair="ADA-USDM",
                    source="Spectrum",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="c48cbb3d5e57ed56e276bc45f99ab39abe94e6cd7ac39fb402da47ad",
                    token_2_name="0014df105553444d",
                    token_2_decimals=6,
                    security_token_policy="fd0b614f52f2286df3b4db4fc70656bcd3df4877e909fd5a44e956f0",
                    security_token_name="0014efbfbd105553444d5f4144415f4e4654",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="CBLP-ADA",
                    source="Spectrum",
                    token_1_policy="ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd",
                    token_1_name="43424c50",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="1e707f0a237ccf47bc9eb02184442459761ab0a0096eed2b27a2f2d9",
                    security_token_name="43424c505f4144415f4e4654",
                    address=None,
                    collector=None,
                ),
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="Spectrum",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="d740d4088886a6b7e4ab8293424308515590e93e826cb874f8c92aff",
                    security_token_name="6f7263666178746f6b656e5f4144415f4e4654",
                    address=None,
                    collector=None,
                ),
            ],
            "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnaytpq3ryg76qvca5eu9c6py33ncg8zf09nh7gy2cvdps2yeqlvvkfh": [
                utxo_objects.TokensPair(
                    pair="ADA-iUSD",
                    source="WingRiders",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                    token_2_name="69555344",
                    token_2_decimals=6,
                    security_token_policy="026a18d04a0c642759bb3d83b12e3344894e5c1c7b2aeb1a2113a570",
                    security_token_name="4c",
                    address=None,
                    collector=None,
                )
            ],
            "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhq7nzm5jzjeevh40p5h3f682mv3r6fnnsldx749n52asr6vsnevx3j": [
                utxo_objects.TokensPair(
                    pair="ADA-iUSD",
                    source="WingRidersV2",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                    token_2_name="69555344",
                    token_2_decimals=6,
                    security_token_policy="6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737",
                    security_token_name="4c",
                    address=None,
                    collector=None,
                )
            ],
            "addr1x8nz307k3sr60gu0e47cmajssy4fmld7u493a4xztjrll0aj764lvrxdayh2ux30fl0ktuh27csgmpevdu89jlxppvrswgxsta": [
                utxo_objects.TokensPair(
                    pair="ADA-iUSD",
                    source="Spectrum",
                    token_1_policy="",
                    token_1_name="lovelace",
                    token_1_decimals=6,
                    token_2_policy="f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b69880",
                    token_2_name="69555344",
                    token_2_decimals=6,
                    security_token_policy="e36480a99003832c2a4dd7b9919915e5c9b5b00244117e5f5ece009d",
                    security_token_name="697573645f4144415f4e4654",
                    address=None,
                    collector=None,
                )
            ],
            "addr1x8srqftqemf0mjlukfszd97ljuxdp44r372txfcr75wrz26rnxqnmtv3hdu2t6chcfhl2zzjh36a87nmd6dwsu3jenqsslnz7e": [
                utxo_objects.TokensPair(
                    pair="CBLP-ADA",
                    source="SundaeSwapV3",
                    token_1_policy="ee0633e757fdd1423220f43688c74678abde1cead7ce265ba8a24fcd",
                    token_1_name="43424c50",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="e0302560ced2fdcbfcb2602697df970cd0d6a38f94b32703f51c312b",
                    security_token_name="000de140549bd196264a186d09e00bcfd41727622e515154612f76dc6b8120b9",
                    address=None,
                    collector=None,
                )
            ],
            "addr1z8nvjzjeydcn4atcd93aac8allvrpjn7pjr2qsweukpnayg6pp9snyy9v7uwarxd7dqc5k52egtc49y5w5h3nqqdy6qs2nzs8y": [
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="WingRiders",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="026a18d04a0c642759bb3d83b12e3344894e5c1c7b2aeb1a2113a570",
                    security_token_name="4c",
                    address=None,
                    collector=None,
                )
            ],
            "addr1zxhew7fmsup08qvhdnkg8ccra88pw7q5trrncja3dlszhqadav244fusrvfjcrdra646ude8dlctzmv6wvsqtndwrdfsvg56qt": [
                utxo_objects.TokensPair(
                    pair="FACT-ADA",
                    source="WingRidersV2",
                    token_1_policy="a3931691f5c4e65d01c429e473d0dd24c51afdb6daf88e632a6c1e51",
                    token_1_name="6f7263666178746f6b656e",
                    token_1_decimals=6,
                    token_2_policy="",
                    token_2_name="lovelace",
                    token_2_decimals=6,
                    security_token_policy="6fdc63a1d71dc2c65502b79baae7fb543185702b12c3c5fb639ed737",
                    security_token_name="4c",
                    address=None,
                    collector=None,
                )
            ],
        },
    ),
]


@time_machine.travel(datetime.datetime(2018, 2, 19, 12, 55, 00, tzinfo=timezone.utc))
@pytest.mark.parametrize("pairs_config, token_pairs", check_token_pairs_tests)
def test_read_pairs_config(pairs_config: list, token_pairs: dict):
    """Test read pairs config and ensure it creates a suitable
    token_pairs struct."""

    res = read_pairs_config(source_config=pairs_config)
    assert res == token_pairs
